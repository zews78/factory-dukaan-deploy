<%- include("../partials/start") %> <%- include("../partials/headBody") %> <%-
include("../partials/header") %>
<body>
  <div class="checkout-card">
    <h4>Order Summary</h4>
    <br />
    <h5><%= packageName %> Pack</h5>
    <br />
    <h5>₹ <%= amount.amount/100  %>.00</h5>
    <p>Validity: 1 Month</p>
    <br />
    <br />
    <ul>
      <li>Benefits..</li>
      <li>Benefits..</li>
      <li>Benefits..</li>
    </ul>

    <div class="order-button">
      <button id="rzp-button1">
        Proceed To Pay
      </button>
    </div>
    <input type="hidden" id="key_id" value="<%= key_id  %>" />
    <input type="hidden" id="order_id" value="<%= orderData.id  %>" />
    <input type="hidden" id="amount" value="<%= amount.amount  %>" />
  </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.2/axios.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.2/axios.min.js"></script>
  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
  <script>
    var options = {
      key: document.getElementById("key_id").value,
      amount: document.getElementById("amount").value,
      currency: "INR",
      name: "Factory Dukan",
      description: "Package Purchase",
      image: "/images/logo.png",
      order_id: document.getElementById("order_id").value,
      handler: async function (response) {
        const res = await axios({
          method: "POST",
          url: "/user/payment/verify",
          data: {
            response,
            amount:document.getElementById("amount").value
          },
        });
        
        if (res.data.status === "success") {
          window.setTimeout(() => {
            location.assign("/user/paymentSuccess");
          }, 0);
        } else {
          console.log("PAYMENT FAILED ☹");
        }
      },
      theme: {
        color: "rgb(247,148,29)",
      },
    };
    var rzp1 = new Razorpay(options);
    document.getElementById("rzp-button1").onclick = function (e) {
      rzp1.open();
      e.preventDefault();
    };
  </script>
</body>
<%- include('../partials/footer.ejs') %> <%- include('../partials/end.ejs') %>
